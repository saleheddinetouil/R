name: SSH Access to Workflow Machine

on: [push, workflow_dispatch]

jobs:
  ssh-access:
    runs-on: ubuntu-latest 
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Get Machine IP Address
        run: |
          # Get the public IP address of the workflow runner
          ip=$(curl -s https://ident.me)
          echo "::set-output name=ip::$ip"

      - name: Install OpenSSH Server
        run: sudo apt-get update && sudo apt-get install openssh-server -y

      - name: Configure SSH Server
        run: |
          # Configure SSH server (change 'your_username' to your desired username)
          sudo sed -i 's/#Port 22/Port 2222/' /etc/ssh/sshd_config 
          sudo systemctl restart ssh
